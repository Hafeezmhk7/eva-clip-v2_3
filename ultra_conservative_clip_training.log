2025-08-02 21:23:37,558 - INFO - 🚀 ULTRA-CONSERVATIVE BLIP3-o CLIP Reproduction Training
2025-08-02 21:23:37,559 - INFO - ================================================================================
2025-08-02 21:23:37,559 - INFO - 📋 Task: Reproduce CLIP embeddings from EVA embeddings
2025-08-02 21:23:37,559 - INFO - 🧠 Model: BLIP3-o DiT with ULTRA-CONSERVATIVE normalization
2025-08-02 21:23:37,560 - INFO - 🌊 Method: Rectified Flow Matching + Robust normalization
2025-08-02 21:23:37,560 - INFO - 🎯 Target: CLIP embeddings [B, N, 1024] (ULTRA-CONSERVATIVE)
2025-08-02 21:23:37,560 - INFO - 🎮 Conditioning: EVA embeddings [B, N, 4096]
2025-08-02 21:23:37,560 - INFO - 🔥 Focus: Training stability and robust performance
2025-08-02 21:23:37,560 - INFO - ================================================================================
2025-08-02 21:23:37,560 - INFO - 🛠️ ULTRA-CONSERVATIVE FEATURES:
2025-08-02 21:23:37,560 - INFO -    ✅ 1. Much smaller scale factor (4.0 → 1.5)
2025-08-02 21:23:37,560 - INFO -    ✅ 2. Percentile-based statistics (robust outlier handling)
2025-08-02 21:23:37,560 - INFO -    ✅ 3. Fallback to identity normalization if needed
2025-08-02 21:23:37,560 - INFO -    ✅ 4. Strict validation ranges (±10 max)
2025-08-02 21:23:37,560 - INFO -    ✅ 5. Conservative clamping and error recovery
2025-08-02 21:23:37,560 - INFO -    ✅ 6. Enhanced error handling throughout
2025-08-02 21:23:37,560 - INFO - ================================================================================
2025-08-02 21:23:37,562 - INFO - Found 35 embedding files
2025-08-02 21:23:37,562 - WARNING - ⚠️ Large batch size (64) may cause memory issues
2025-08-02 21:23:37,562 - INFO - ULTRA-CONSERVATIVE Configuration:
2025-08-02 21:23:37,562 - INFO -   Model size: base
2025-08-02 21:23:37,562 - INFO -   Training mode: patch_only
2025-08-02 21:23:37,562 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 21:23:37,563 - INFO -   Output dir: ./checkpoints/blip3o_clean_20250802_212334
2025-08-02 21:23:37,563 - INFO -   Learning rate: 0.0001
2025-08-02 21:23:37,563 - INFO -   Batch size: 64
2025-08-02 21:23:37,563 - INFO -   Epochs: 10
2025-08-02 21:23:37,563 - INFO -   Max shards: 3
2025-08-02 21:23:37,563 - INFO -   Loss weights:
2025-08-02 21:23:37,563 - INFO -     Velocity: 1.0
2025-08-02 21:23:37,563 - INFO -     Semantic: 0.5
2025-08-02 21:23:37,563 - INFO -     Cosine: 0.2
2025-08-02 21:23:37,563 - INFO -     Consistency: 0.3
2025-08-02 21:23:37,563 - INFO -   EVA adapter: ✅ ENABLED
2025-08-02 21:23:37,563 - INFO -   Heun inference: ✅ ENABLED
2025-08-02 21:23:38,179 - INFO - Using GPU: NVIDIA H100
2025-08-02 21:23:38,179 - INFO - GPU Memory: 100.0 GB
2025-08-02 21:23:38,179 - INFO - PyTorch version: 2.7.1+cu126
2025-08-02 21:23:44,882 - INFO - ✅ CLIP DiT model loaded successfully
2025-08-02 21:23:44,887 - INFO - ✅ Flow matching loss loaded successfully
2025-08-02 21:23:46,227 - INFO - ✅ CLIP trainer loaded successfully
2025-08-02 21:23:46,232 - WARNING - ⚠️ Failed to import dataset: cannot import name 'create_clip_reproduction_dataloaders' from 'src.modules.datasets.blip3o_dataset' (/gpfs/home4/azadaianchuk1/eva-clip-v6_2/src/modules/datasets/blip3o_dataset.py)
2025-08-02 21:23:46,237 - INFO - ✅ Configuration loaded successfully
2025-08-02 21:23:46,237 - WARNING - ⚠️ Missing components: ['dataset']
2025-08-02 21:23:46,237 - WARNING - ⚠️ Partial initialization. Missing: ['dataset']
2025-08-02 21:23:46,237 - INFO - ✅ Ultra-conservative dataset module loaded
2025-08-02 21:23:46,237 - INFO - ✅ Improved model module loaded
2025-08-02 21:23:46,237 - INFO - ✅ Fixed loss module loaded
2025-08-02 21:23:46,237 - INFO - ✅ Fixed trainer module loaded
2025-08-02 21:23:46,237 - INFO - ✅ All required modules loaded successfully
2025-08-02 21:23:46,238 - INFO - ✅ Environment check passed
2025-08-02 21:23:46,238 - INFO - ✅ Output directory ready: checkpoints/blip3o_clean_20250802_212334
2025-08-02 21:23:46,238 - INFO - 🏗️ Creating model...
2025-08-02 21:23:46,238 - INFO - ✅ Configuration validation passed
2025-08-02 21:23:46,669 - INFO - ✅ EVA-CLIP Adapter initialized: 4096 → 768
2025-08-02 21:23:46,669 - INFO -    Layers: 6, Dropout: 0.1, Residual: True
2025-08-02 21:23:48,103 - INFO - ✅ Stable initialization applied with depth scale: 0.2887
2025-08-02 21:23:48,106 - INFO - ✅ IMPROVED BLIP3-o CLIP DiT model initialized: 227,474,014 parameters
2025-08-02 21:23:48,106 - INFO -   🔥 EVA adapter: ENABLED
2025-08-02 21:23:48,106 - INFO -   🚀 Heun solver: ENABLED
2025-08-02 21:23:48,106 - INFO -   ⚡ Attention caching: Available
2025-08-02 21:23:48,106 - INFO - ✅ IMPROVED BLIP3-o model created:
2025-08-02 21:23:48,107 - INFO -    Size: base
2025-08-02 21:23:48,108 - INFO -    Parameters: 227,474,014
2025-08-02 21:23:48,108 - INFO -    EVA adapter: ✅
2025-08-02 21:23:48,108 - INFO -    Heun solver: ✅
2025-08-02 21:23:48,108 - INFO -    3D RoPE: ✅
2025-08-02 21:23:48,108 - INFO -    Sandwich norm: ✅
2025-08-02 21:23:48,337 - INFO - ✅ Model created with 227,474,014 parameters
2025-08-02 21:23:48,337 - INFO -   Model size: base
2025-08-02 21:23:48,337 - INFO -   Training mode: patch_only
2025-08-02 21:23:48,337 - INFO -   3D RoPE: ✅ ENABLED
2025-08-02 21:23:48,337 - INFO -   Sandwich Norm: ✅ ENABLED
2025-08-02 21:23:48,337 - INFO -   EVA Adapter: ✅ ENABLED
2025-08-02 21:23:48,337 - INFO -   Heun Solver: ✅ ENABLED
2025-08-02 21:23:48,337 - INFO - 🌊 Creating loss function...
2025-08-02 21:23:48,338 - INFO - ✅ ROBUST Flow Matching Loss initialized:
2025-08-02 21:23:48,338 - INFO -   Prediction type: velocity
2025-08-02 21:23:48,338 - INFO -   Flow type: rectified
2025-08-02 21:23:48,338 - INFO -   Weights - Velocity: 1.0, Semantic: 0.5, Cosine: 0.2
2025-08-02 21:23:48,338 - INFO -   Consistency weight: 0.3
2025-08-02 21:23:48,338 - INFO -   🔒 Robust features: stability checks, adaptive scaling, overflow protection
2025-08-02 21:23:48,338 - INFO - ✅ ULTRA-CONSERVATIVE loss function created:
2025-08-02 21:23:48,338 - INFO -   Prediction type: velocity
2025-08-02 21:23:48,338 - INFO -   Flow type: rectified
2025-08-02 21:23:48,338 - INFO -   Weights - Velocity: 1.0, Semantic: 0.5, Cosine: 0.2
2025-08-02 21:23:48,338 - INFO -   Consistency weight: 0.3
2025-08-02 21:23:48,338 - INFO -   Timestep weighting: ✅ ENABLED
2025-08-02 21:23:48,338 - INFO - 📊 Creating ULTRA-CONSERVATIVE dataloaders...
2025-08-02 21:23:48,338 - INFO - Loading embeddings from: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 21:23:48,339 - INFO - Found 35 .pkl files in embeddings directory
2025-08-02 21:23:48,339 - INFO - Creating ULTRA-CONSERVATIVE CLIP reproduction dataloaders:
2025-08-02 21:23:48,339 - INFO -   Target: CLIP embeddings [B, N, 1024] (ULTRA-CONSERVATIVE NORMALIZATION)
2025-08-02 21:23:48,339 - INFO -   Conditioning: EVA embeddings [B, N, 4096]
2025-08-02 21:23:48,339 - INFO -   Timestep sampling: U-shaped distribution
2025-08-02 21:23:48,382 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-02 21:23:48,383 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-02 21:23:48,385 - INFO - Prepared 3 shard files
2025-08-02 21:23:48,385 - INFO - Computing ULTRA-CONSERVATIVE CLIP statistics from 3 shards...
2025-08-02 21:23:54,632 - INFO -    Processed shard 1: torch.Size([2601, 256, 1024]) -> 10000 samples
2025-08-02 21:24:00,169 - INFO -    Processed shard 2: torch.Size([2646, 256, 1024]) -> 10000 samples
2025-08-02 21:24:04,927 - INFO -    Processed shard 3: torch.Size([2585, 256, 1024]) -> 10000 samples
2025-08-02 21:24:04,938 - INFO - Computing stats from 30,000 embedding vectors
2025-08-02 21:24:04,952 - INFO -    Removed 2217 samples with extreme norms
2025-08-02 21:24:07,289 - INFO -    Final outlier removal: 4206 samples (14.0%)
2025-08-02 21:24:16,862 - INFO - ✅ ULTRA-CONSERVATIVE CLIP normalization statistics computed:
2025-08-02 21:24:16,871 - INFO -    Median range: [-7.257812, 5.835938]
2025-08-02 21:24:16,872 - INFO -    Std range: [0.923756, 4.865451]
2025-08-02 21:24:16,872 - INFO -    Scale factor: 1.50 (ULTRA-CONSERVATIVE)
2025-08-02 21:24:16,872 - INFO -    Data range (1%-99%): [-10.484, 10.055]
2025-08-02 21:24:16,874 - INFO -    Normalized range: [-3.77, 3.75]
2025-08-02 21:24:16,879 - INFO -    ✅ Normalization validation passed - safe for training
2025-08-02 21:24:16,893 - INFO - Using manifest for length estimation: 7,828 samples
2025-08-02 21:24:16,893 - INFO - ULTRA-CONSERVATIVE CLIP Reproduction Dataset initialized:
2025-08-02 21:24:16,893 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 21:24:16,893 - INFO -   Mode: patch_only (256 tokens)
2025-08-02 21:24:16,893 - INFO -   TARGET: CLIP embeddings [B, N, 1024] (ULTRA-CONSERVATIVE NORMALIZATION)
2025-08-02 21:24:16,893 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-02 21:24:16,893 - INFO -   Shards: 3
2025-08-02 21:24:16,893 - INFO -   ✅ ULTRA-CONSERVATIVE CLIP normalization: ENABLED
2025-08-02 21:24:16,894 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-02 21:24:16,894 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-02 21:24:16,894 - INFO - Prepared 3 shard files
2025-08-02 21:24:16,894 - INFO - Computing ULTRA-CONSERVATIVE CLIP statistics from 3 shards...
2025-08-02 21:24:22,378 - INFO -    Processed shard 1: torch.Size([2646, 256, 1024]) -> 10000 samples
2025-08-02 21:24:27,469 - INFO -    Processed shard 2: torch.Size([2601, 256, 1024]) -> 10000 samples
2025-08-02 21:24:32,341 - INFO -    Processed shard 3: torch.Size([2585, 256, 1024]) -> 10000 samples
2025-08-02 21:24:32,345 - INFO - Computing stats from 30,000 embedding vectors
2025-08-02 21:24:32,351 - INFO -    Removed 2225 samples with extreme norms
2025-08-02 21:24:34,671 - INFO -    Final outlier removal: 4252 samples (14.2%)
2025-08-02 21:24:44,198 - INFO - ✅ ULTRA-CONSERVATIVE CLIP normalization statistics computed:
2025-08-02 21:24:44,198 - INFO -    Median range: [-7.250000, 5.851562]
2025-08-02 21:24:44,198 - INFO -    Std range: [0.924479, 4.898727]
2025-08-02 21:24:44,198 - INFO -    Scale factor: 1.50 (ULTRA-CONSERVATIVE)
2025-08-02 21:24:44,199 - INFO -    Data range (1%-99%): [-10.500, 10.457]
2025-08-02 21:24:44,200 - INFO -    Normalized range: [-3.69, 3.75]
2025-08-02 21:24:44,200 - INFO -    ✅ Normalization validation passed - safe for training
2025-08-02 21:24:44,214 - INFO - Using manifest for length estimation: 7,828 samples
2025-08-02 21:24:44,214 - INFO - ULTRA-CONSERVATIVE CLIP Reproduction Dataset initialized:
2025-08-02 21:24:44,214 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 21:24:44,214 - INFO -   Mode: patch_only (256 tokens)
2025-08-02 21:24:44,214 - INFO -   TARGET: CLIP embeddings [B, N, 1024] (ULTRA-CONSERVATIVE NORMALIZATION)
2025-08-02 21:24:44,214 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-02 21:24:44,214 - INFO -   Shards: 3
2025-08-02 21:24:44,214 - INFO -   ✅ ULTRA-CONSERVATIVE CLIP normalization: ENABLED
2025-08-02 21:24:44,215 - INFO - ✅ ULTRA-CONSERVATIVE CLIP reproduction dataloaders created
2025-08-02 21:24:44,215 - INFO -   Training dataset length: 7,828
2025-08-02 21:24:44,215 - INFO -   Evaluation dataset length: 7,828
2025-08-02 21:24:44,215 - INFO -   🔥 ULTRA-CONSERVATIVE CLIP normalization: PROPERLY CONFIGURED
2025-08-02 21:24:44,215 - INFO - ✅ ULTRA-CONSERVATIVE dataloaders created successfully:
2025-08-02 21:24:44,215 - INFO -   Training mode: patch_only
2025-08-02 21:24:44,215 - INFO -   Batch size: 64
2025-08-02 21:24:44,215 - INFO -   Max shards: 3
2025-08-02 21:24:44,215 - INFO -   🔥 ULTRA-CONSERVATIVE CLIP normalization: ✅ CONFIGURED
2025-08-02 21:24:49,160 - INFO - ✅ Dataloader test successful:
2025-08-02 21:24:49,162 - INFO -   Batch size: 64
2025-08-02 21:24:49,162 - INFO -   CLIP embeddings shape: torch.Size([64, 256, 1024])
2025-08-02 21:24:49,162 - INFO -   EVA embeddings shape: torch.Size([64, 256, 4096])
2025-08-02 21:24:49,162 - INFO -   🔥 CLIP normalizer: ✅ AVAILABLE
2025-08-02 21:24:49,163 - INFO -      Stats computed: True
2025-08-02 21:24:49,163 - INFO -      Scale factor: 1.50 (ULTRA-CONSERVATIVE)
2025-08-02 21:24:49,164 - INFO -      Normalized range: [-8.00, 8.00]
2025-08-02 21:24:49,164 - INFO -      ✅ Normalization range acceptable for training
2025-08-02 21:24:49,164 - INFO - 🏃 Creating trainer...
2025-08-02 21:24:49,168 - INFO - Got exact dataloader length: 122
2025-08-02 21:24:49,169 - INFO - ✅ Conservative optimizer setup complete
2025-08-02 21:24:49,170 - INFO - ✅ Mixed precision enabled
2025-08-02 21:24:49,170 - INFO - ✅ ENHANCED BLIP3-o Trainer initialized
2025-08-02 21:24:49,170 - INFO -   Device: cuda
2025-08-02 21:24:49,171 - INFO -   Parameters: 227,474,014
2025-08-02 21:24:49,171 - INFO -   CLIP normalizer: ✅ AVAILABLE
2025-08-02 21:24:49,171 - INFO -   🔥 DENORMALIZED EVALUATION: ✅ ENABLED
2025-08-02 21:24:49,171 - INFO -   📊 Image generation validation: Ready
2025-08-02 21:24:49,171 - INFO - ✅ ULTRA-CONSERVATIVE trainer created successfully:
2025-08-02 21:24:49,171 - INFO -   Evaluation: Every 50 steps
2025-08-02 21:24:49,171 - INFO -   WandB enabled: False
2025-08-02 21:24:49,171 - INFO -   CLIP normalizer: ✅ AVAILABLE
2025-08-02 21:24:49,171 - INFO -   Heun inference: ✅ ENABLED
2025-08-02 21:24:49,171 - INFO - 💾 Saving experiment configuration...
2025-08-02 21:24:49,173 - INFO - ✅ Configuration saved to checkpoints/blip3o_clean_20250802_212334/experiment_config.json
2025-08-02 21:24:49,173 - INFO - 
🚀 Starting ULTRA-CONSERVATIVE BLIP3-o training...
2025-08-02 21:24:49,173 - INFO - ================================================================================
2025-08-02 21:24:49,173 - INFO - 🎯 Expected Results:
2025-08-02 21:24:49,173 - INFO -    • Stable training without normalization crashes
2025-08-02 21:24:49,173 - INFO -    • Gradual improvement in CLIP similarity
2025-08-02 21:24:49,173 - INFO -    • No extreme gradient/loss spikes
2025-08-02 21:24:49,173 - INFO -    • Robust handling of outliers
2025-08-02 21:24:49,173 - INFO - ================================================================================
2025-08-02 21:24:49,174 - INFO - 🚀 Starting ENHANCED BLIP3-o training with denormalized evaluation...
2025-08-02 21:24:49,174 - INFO -   🔥 Denormalized evaluation: ENABLED
2025-08-02 21:24:49,174 - INFO -   📊 Image generation validation: Active
2025-08-02 21:24:49,175 - INFO - Starting epoch 1/10
2025-08-02 21:25:00,231 - INFO - Step 10: Loss=1.876060, GradNorm=15870.557, Failures=0
2025-08-02 21:25:00,826 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:01,436 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:02,047 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:02,656 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:03,268 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:03,879 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:04,489 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:05,100 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:05,711 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:06,323 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:06,339 - INFO - Step 20: Loss=1.873453, GradNorm=39109.229, Failures=0
2025-08-02 21:25:06,934 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:07,546 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:08,157 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:08,768 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:09,381 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:09,993 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:10,605 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:11,215 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:11,827 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:12,438 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:12,455 - INFO - Step 30: Loss=1.869244, GradNorm=55044.360, Failures=0
2025-08-02 21:25:13,050 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:13,662 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:14,273 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:14,885 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:15,496 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:16,108 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:16,720 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:17,334 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:17,945 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:18,557 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:18,573 - INFO - Step 40: Loss=1.853125, GradNorm=18733.804, Failures=0
2025-08-02 21:25:24,521 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:25,136 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:25,749 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:26,362 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:26,974 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:27,586 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:28,199 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:28,810 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:29,424 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:30,036 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:25:30,052 - INFO - Step 50: Loss=1.875617, GradNorm=37175.170, Failures=0
2025-08-02 21:25:30,052 - INFO - Running ENHANCED evaluation at step 50...
2025-08-02 21:25:30,052 - INFO - Starting ENHANCED evaluation with 100 samples
2025-08-02 21:25:30,052 - INFO - 🔥 Denormalized evaluation: ENABLED
2025-08-02 21:26:16,848 - INFO - 🔥 Computing denormalized similarities for image generation validation...
2025-08-02 21:26:16,925 - INFO - 🎉 NEW BEST denormalized similarity: 0.8703
2025-08-02 21:26:16,925 - INFO - ✅ ENHANCED evaluation completed: 128 samples
2025-08-02 21:26:16,925 - INFO -    Normalized similarity: 0.1649
2025-08-02 21:26:16,925 - INFO -    🔥 Denormalized similarity: 0.8703
2025-08-02 21:26:16,925 - INFO -    📊 Image generation ready: True
2025-08-02 21:26:16,925 - INFO -    Success rate: 100.0%
2025-08-02 21:26:16,928 - INFO - ✅ Evaluation: CLIP similarity = 0.8703
2025-08-02 21:26:16,928 - INFO -    🔥 Denormalized similarity = 0.8703
2025-08-02 21:26:16,928 - INFO - 🎉 NEW BEST similarity: 0.8703
2025-08-02 21:26:17,519 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:18,125 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:18,733 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:19,340 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:19,948 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:20,556 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:21,164 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:21,772 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:22,379 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:22,987 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:23,003 - INFO - Step 60: Loss=1.846004, GradNorm=54572.509, Failures=0
2025-08-02 21:26:23,595 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:24,204 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:24,812 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:25,422 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:26,030 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:26,639 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:27,247 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:27,854 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:28,463 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:29,071 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:29,088 - INFO - Step 70: Loss=1.881513, GradNorm=113912.283, Failures=0
2025-08-02 21:26:29,678 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:30,286 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:30,894 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:31,502 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:32,109 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:32,718 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:33,326 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:33,934 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:34,542 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:35,149 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:35,165 - INFO - Step 80: Loss=1.856048, GradNorm=28615.722, Failures=0
2025-08-02 21:26:35,756 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:40,873 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:41,481 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:42,089 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:42,700 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:43,308 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:43,918 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:44,526 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:45,133 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:45,741 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:45,757 - INFO - Step 90: Loss=1.831704, GradNorm=85368.041, Failures=0
2025-08-02 21:26:46,350 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:46,958 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:47,566 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:48,173 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:48,781 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:49,389 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:49,998 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:50,606 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:51,213 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:51,820 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:26:51,836 - INFO - Step 100: Loss=1.803011, GradNorm=21140.827, Failures=0
2025-08-02 21:26:51,836 - INFO - Running ENHANCED evaluation at step 100...
2025-08-02 21:26:51,836 - INFO - Starting ENHANCED evaluation with 100 samples
2025-08-02 21:26:51,836 - INFO - 🔥 Denormalized evaluation: ENABLED
2025-08-02 21:27:38,527 - INFO - 🔥 Computing denormalized similarities for image generation validation...
2025-08-02 21:27:38,603 - INFO - 🎉 NEW BEST denormalized similarity: 0.8810
2025-08-02 21:27:38,603 - INFO - ✅ ENHANCED evaluation completed: 128 samples
2025-08-02 21:27:38,603 - INFO -    Normalized similarity: 0.0310
2025-08-02 21:27:38,603 - INFO -    🔥 Denormalized similarity: 0.8810
2025-08-02 21:27:38,603 - INFO -    📊 Image generation ready: True
2025-08-02 21:27:38,603 - INFO -    Success rate: 100.0%
2025-08-02 21:27:38,606 - INFO - ✅ Evaluation: CLIP similarity = 0.8810
2025-08-02 21:27:38,606 - INFO -    🔥 Denormalized similarity = 0.8810
2025-08-02 21:27:38,606 - INFO - 🎉 NEW BEST similarity: 0.8810
2025-08-02 21:27:39,199 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:39,807 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:40,415 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:41,023 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:41,631 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:42,239 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:42,848 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:43,455 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:44,063 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:44,671 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:44,687 - INFO - Step 110: Loss=1.845545, GradNorm=26571.219, Failures=0
2025-08-02 21:27:45,280 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:45,889 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:46,497 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:47,105 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:47,714 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:48,324 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:48,935 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:49,545 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:50,155 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:50,764 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:50,781 - INFO - Step 120: Loss=1.811391, GradNorm=36738.734, Failures=0
2025-08-02 21:27:51,373 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:51,984 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:52,156 - INFO - Iteration completed: 7832 samples processed
2025-08-02 21:27:52,157 - INFO - Epoch 1 completed: 122 batches, 0 failures
2025-08-02 21:27:52,171 - INFO - Epoch 1 summary:
2025-08-02 21:27:52,171 - INFO -   Average loss: 1.857066
2025-08-02 21:27:52,171 - INFO -   Failure rate: 0.0%
2025-08-02 21:27:52,171 - INFO -   Emergency LR reductions: 0
2025-08-02 21:27:52,171 - INFO -   Best similarity: 0.8810
2025-08-02 21:27:52,171 - INFO -   Best denorm similarity: 0.8810
2025-08-02 21:27:52,171 - INFO -   Denorm warnings: 0
2025-08-02 21:27:52,171 - INFO - Starting epoch 2/10
2025-08-02 21:27:57,142 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:57,752 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:58,361 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:58,970 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:27:59,579 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:00,190 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:00,798 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:01,406 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:01,423 - INFO - Step 130: Loss=1.829922, GradNorm=8398.093, Failures=0
2025-08-02 21:28:02,016 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:02,627 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:03,238 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:03,850 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:04,458 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:05,067 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:05,676 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:06,285 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:06,895 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:07,504 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:07,521 - INFO - Step 140: Loss=1.748935, GradNorm=14852.685, Failures=0
2025-08-02 21:28:08,117 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:08,727 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:09,337 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:09,948 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:10,559 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:11,168 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:11,777 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:12,387 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:12,997 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:13,606 - WARNING - ⚠️ High gradients detected, using stricter clipping: 0.500
2025-08-02 21:28:13,623 - INFO - Step 150: Loss=1.804112, GradNorm=10952.459, Failures=0
2025-08-02 21:28:13,623 - INFO - Running ENHANCED evaluation at step 150...
2025-08-02 21:28:13,623 - INFO - Starting ENHANCED evaluation with 100 samples
2025-08-02 21:28:13,623 - INFO - 🔥 Denormalized evaluation: ENABLED
