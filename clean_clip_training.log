2025-08-01 21:29:47,676 - INFO - üöÄ Clean BLIP3-o CLIP Reproduction Training
2025-08-01 21:29:47,677 - INFO - ============================================================
2025-08-01 21:29:47,677 - INFO - üìã Task: Reproduce CLIP embeddings from EVA embeddings
2025-08-01 21:29:47,678 - INFO - üß† Model: BLIP3-o DiT with 3D RoPE and Sandwich Normalization
2025-08-01 21:29:47,678 - INFO - üåä Method: Rectified Flow Matching
2025-08-01 21:29:47,678 - INFO - üéØ Target: CLIP embeddings [B, N, 1024]
2025-08-01 21:29:47,678 - INFO - üéÆ Conditioning: EVA embeddings [B, N, 4096]
2025-08-01 21:29:47,678 - INFO - ============================================================
2025-08-01 21:29:47,679 - INFO - Configuration:
2025-08-01 21:29:47,679 - INFO -   Model size: base
2025-08-01 21:29:47,679 - INFO -   Training mode: patch_only
2025-08-01 21:29:47,679 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 21:29:47,679 - INFO -   Output dir: ./checkpoints/blip3o_clean_20250801_212944
2025-08-01 21:29:47,680 - INFO -   Learning rate: 0.0001
2025-08-01 21:29:47,680 - INFO -   Batch size: 64
2025-08-01 21:29:47,680 - INFO -   Epochs: 3
2025-08-01 21:29:47,680 - INFO -   Max shards: 1
2025-08-01 21:29:48,098 - INFO - Using GPU: NVIDIA H100
2025-08-01 21:29:48,099 - INFO - GPU Memory: 100.0 GB
2025-08-01 21:29:48,099 - INFO - PyTorch version: 2.7.1+cu126
2025-08-01 21:29:48,099 - INFO - ‚úÖ Environment check passed
2025-08-01 21:29:48,099 - INFO - ‚úÖ Output directory ready: checkpoints/blip3o_clean_20250801_212944
2025-08-01 21:29:48,099 - INFO - üèóÔ∏è Creating model...
2025-08-01 21:29:54,557 - INFO - ‚úÖ CLIP DiT model loaded successfully
2025-08-01 21:29:54,560 - INFO - ‚úÖ Flow matching loss loaded successfully
2025-08-01 21:29:55,869 - INFO - ‚úÖ CLIP trainer loaded successfully
2025-08-01 21:29:55,875 - INFO - ‚úÖ CLIP datasets loaded successfully
2025-08-01 21:29:55,881 - INFO - ‚úÖ Configuration loaded successfully
2025-08-01 21:29:55,882 - INFO - üéâ All CLIP reproduction components loaded successfully!
2025-08-01 21:29:55,882 - INFO - üéâ Clean BLIP3-o CLIP reproduction modules fully initialized!
2025-08-01 21:29:55,882 - INFO - üéØ Ready for EVA ‚Üí CLIP reproduction training
2025-08-01 21:29:57,635 - INFO - CORRECTED BLIP3-o CLIP DiT model with SwiGLU initialized: 221,027,584 parameters
2025-08-01 21:29:57,635 - INFO -   ‚úÖ 3D RoPE: True
2025-08-01 21:29:57,635 - INFO -   ‚úÖ Sandwich Normalization: True
2025-08-01 21:29:57,635 - INFO -   ‚úÖ Grouped-Query Attention: 12/4 heads
2025-08-01 21:29:57,635 - INFO -   ‚úÖ SwiGLU activation: Now properly implemented!
2025-08-01 21:29:57,859 - INFO - Model created with 221,027,584 parameters
2025-08-01 21:29:57,859 - INFO -   Model size: base
2025-08-01 21:29:57,859 - INFO -   Training mode: patch_only
2025-08-01 21:29:57,859 - INFO -   3D RoPE: Enabled
2025-08-01 21:29:57,859 - INFO -   Sandwich Norm: Enabled
2025-08-01 21:29:57,859 - INFO - üåä Creating loss function...
2025-08-01 21:29:57,859 - INFO - Clean CLIP Flow Matching Loss initialized:
2025-08-01 21:29:57,859 - INFO -   Prediction type: velocity
2025-08-01 21:29:57,860 - INFO -   Flow type: rectified
2025-08-01 21:29:57,860 - INFO - Loss function created:
2025-08-01 21:29:57,860 - INFO -   Prediction type: velocity
2025-08-01 21:29:57,860 - INFO -   Flow type: rectified
2025-08-01 21:29:57,860 - INFO - üìä Creating dataloaders...
2025-08-01 21:29:57,860 - INFO - Loading embeddings from: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 21:29:57,860 - INFO - Found 35 .pkl files in embeddings directory
2025-08-01 21:29:57,860 - INFO - Creating clean CLIP reproduction dataloaders:
2025-08-01 21:29:57,860 - INFO -   Target: CLIP embeddings [B, N, 1024]
2025-08-01 21:29:57,860 - INFO -   Conditioning: EVA embeddings [B, N, 4096]
2025-08-01 21:29:57,861 - INFO -   Noise: Standard Gaussian
2025-08-01 21:29:57,887 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-01 21:29:57,888 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-01 21:29:57,888 - INFO - Prepared 1 shard files
2025-08-01 21:29:57,888 - INFO - Using manifest for length estimation: 2,609 samples
2025-08-01 21:29:57,888 - INFO - Clean CLIP Reproduction Dataset initialized:
2025-08-01 21:29:57,888 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 21:29:57,888 - INFO -   Mode: patch_only (256 tokens)
2025-08-01 21:29:57,888 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-08-01 21:29:57,888 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-01 21:29:57,888 - INFO -   Shards: 1
2025-08-01 21:29:57,889 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-01 21:29:57,889 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-01 21:29:57,889 - INFO - Prepared 1 shard files
2025-08-01 21:29:57,889 - INFO - Using manifest for length estimation: 2,609 samples
2025-08-01 21:29:57,889 - INFO - Clean CLIP Reproduction Dataset initialized:
2025-08-01 21:29:57,889 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 21:29:57,889 - INFO -   Mode: patch_only (256 tokens)
2025-08-01 21:29:57,889 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-08-01 21:29:57,890 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-01 21:29:57,890 - INFO -   Shards: 1
2025-08-01 21:29:57,890 - INFO - Clean CLIP reproduction dataloaders created successfully
2025-08-01 21:29:57,890 - INFO -   Training dataset length: 2,609
2025-08-01 21:29:57,890 - INFO -   Evaluation dataset length: 2,609
2025-08-01 21:29:57,890 - INFO - Dataloaders created successfully:
2025-08-01 21:29:57,890 - INFO -   Training mode: patch_only
2025-08-01 21:29:57,890 - INFO -   Batch size: 64
2025-08-01 21:29:57,890 - INFO -   Max shards: 1
