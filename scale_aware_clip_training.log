2025-08-01 13:51:13,334 - INFO - üöÄ BLIP3-o CLIP Reproduction Training with Scale-Aware Generation
2025-08-01 13:51:13,334 - INFO - ==========================================================================================
2025-08-01 13:51:13,334 - INFO - üéØ SCALE-AWARE GENERATION ENABLED:
2025-08-01 13:51:13,334 - INFO -   ‚úÖ Log-normal timestep scheduling for better sampling
2025-08-01 13:51:13,334 - INFO -   ‚úÖ Velocity explosion prevention during inference
2025-08-01 13:51:13,334 - INFO -   ‚úÖ Periodic norm guidance for scale consistency
2025-08-01 13:51:13,334 - INFO -   ‚úÖ Adaptive target norm estimation from data
2025-08-01 13:51:13,334 - INFO -   ‚úÖ Enhanced evaluation with scale-aware metrics
2025-08-01 13:51:13,334 - INFO - ==========================================================================================
2025-08-01 13:51:13,334 - INFO - EXPERIMENT DETAILS:
2025-08-01 13:51:13,334 - INFO -   üìã Task: Reproduce clean CLIP embeddings from EVA embeddings
2025-08-01 13:51:13,334 - INFO -   üß† Model: BLIP3-o DiT with 3D RoPE and Sandwich Normalization
2025-08-01 13:51:13,334 - INFO -   üéØ Target: CLIP embeddings [B, N, 1024]
2025-08-01 13:51:13,334 - INFO -   üéÆ Conditioning: EVA embeddings [B, N, 4096]
2025-08-01 13:51:13,334 - INFO -   üåä Method: Rectified Flow Matching
2025-08-01 13:51:13,334 - INFO -   üöÄ Generation: Scale-aware with log-normal scheduling
2025-08-01 13:51:13,335 - INFO -   üéØ Target norm guidance: 26.0
2025-08-01 13:51:13,335 - INFO -   ‚ö° Velocity explosion threshold: 100.0
2025-08-01 13:51:13,335 - INFO -   üìä Norm guidance strength: 0.10
2025-08-01 13:51:13,335 - INFO - ==========================================================================================
2025-08-01 13:51:13,335 - INFO - Configuration:
2025-08-01 13:51:13,335 - INFO -   Model size: base
2025-08-01 13:51:13,335 - INFO -   Training mode: patch_only
2025-08-01 13:51:13,335 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 13:51:13,335 - INFO -   Output dir: ./checkpoints/clip_repro_20250801_135108
2025-08-01 13:51:13,335 - INFO -   Learning rate: 0.0001
2025-08-01 13:51:13,335 - INFO -   Batch size: 8
2025-08-01 13:51:13,335 - INFO -   Epochs: 10
2025-08-01 13:51:13,335 - INFO -   Max shards: 2
2025-08-01 13:51:13,335 - INFO -   üß™ Overfitting test: 20 samples
2025-08-01 13:51:13,335 - INFO -   Debug mode: False
2025-08-01 13:51:13,335 - INFO - ==========================================================================================
2025-08-01 13:51:13,834 - INFO - Using GPU: NVIDIA H100
2025-08-01 13:51:13,835 - INFO - GPU Memory: 100.0 GB
2025-08-01 13:51:13,835 - INFO - üèóÔ∏è BLIP3-o Architecture Configuration:
2025-08-01 13:51:13,835 - INFO -   3D Rotary Position Embedding: ‚úÖ Enabled
2025-08-01 13:51:13,835 - INFO -   Sandwich Normalization: ‚úÖ Enabled
2025-08-01 13:51:13,835 - INFO -   üöÄ Scale-Aware Generation: ‚úÖ Enabled
2025-08-01 13:51:13,835 - INFO - üéØ Scale-Aware Parameters:
2025-08-01 13:51:13,835 - INFO -   Typical CLIP norm: 26.0
2025-08-01 13:51:13,835 - INFO -   Velocity explosion threshold: 100.0
2025-08-01 13:51:13,835 - INFO -   Norm guidance strength: 0.1
2025-08-01 13:51:13,835 - INFO -   Norm guidance frequency: 10
2025-08-01 13:51:13,835 - INFO -   Log-normal schedule: True
2025-08-01 13:51:13,835 - INFO -   Adaptive target norm: True
2025-08-01 13:51:25,104 - INFO - ‚úÖ CLIP DiT model loaded from src/modules/models/blip3o_dit.py
2025-08-01 13:51:25,110 - INFO - ‚úÖ Flow matching loss loaded from src/modules/losses/blip3o_fm_loss.py
2025-08-01 13:51:27,357 - INFO - ‚úÖ CLIP trainer loaded from src/modules/trainers/blip3o_trainer.py
2025-08-01 13:51:27,364 - INFO - ‚úÖ CLIP datasets loaded from src/modules/datasets/blip3o_dataset.py
2025-08-01 13:51:27,376 - INFO - ‚úÖ Configuration loaded from src/modules/config/blip3o_config.py
2025-08-01 13:51:27,376 - INFO - üéâ All CLIP reproduction components loaded successfully!
2025-08-01 13:51:27,376 - INFO - üéâ BLIP3-o CLIP reproduction modules fully initialized!
2025-08-01 13:51:27,376 - INFO - üö´ Using minimal normalization approach
2025-08-01 13:51:27,376 - INFO - üéØ Ready for EVA ‚Üí CLIP reproduction training
2025-08-01 13:51:27,376 - INFO - ‚úÖ Imported UPDATED model with scale-aware generation
2025-08-01 13:51:29,406 - INFO - UPDATED BLIP3-o CLIP DiT model initialized with 249,339,136 parameters
2025-08-01 13:51:29,406 - INFO -   3D RoPE: True
2025-08-01 13:51:29,406 - INFO -   Sandwich Normalization: True
2025-08-01 13:51:29,406 - INFO -   üéØ Typical CLIP norm: 26.0
2025-08-01 13:51:29,406 - INFO -   üöÄ Scale-aware generation enabled
2025-08-01 13:51:29,641 - INFO - Model created with 249,339,136 parameters
2025-08-01 13:51:29,641 - INFO - Model moved to cuda
2025-08-01 13:51:29,641 - INFO - ‚úÖ Imported loss function
2025-08-01 13:51:29,642 - INFO - FIXED CLIP Flow Matching Loss initialized (NO NOISE SCALING):
2025-08-01 13:51:29,642 - INFO -   Prediction type: velocity
2025-08-01 13:51:29,642 - INFO -   Flow type: rectified
2025-08-01 13:51:29,642 - INFO -   Noise scaling: DISABLED (always standard Gaussian)
2025-08-01 13:51:29,642 - INFO -   Debug mode: False
2025-08-01 13:51:29,642 - INFO -   üé≤ Noise: Standard Gaussian (mean=0, std=1) everywhere
2025-08-01 13:51:29,642 - INFO - Loss function created:
2025-08-01 13:51:29,642 - INFO -   Prediction type: velocity
2025-08-01 13:51:29,642 - INFO -   Flow type: rectified
2025-08-01 13:51:29,642 - INFO -   Standard Gaussian noise
2025-08-01 13:51:29,642 - INFO - ‚úÖ Imported dataset
2025-08-01 13:51:29,642 - INFO - FIXED: Creating CLIP reproduction dataloaders (NO NOISE SCALING):
2025-08-01 13:51:29,642 - INFO -   Target: CLIP embeddings [B, N, 1024] - RAW (no normalization)
2025-08-01 13:51:29,642 - INFO -   Conditioning: EVA embeddings [B, N, 4096] - RAW (no normalization)
2025-08-01 13:51:29,642 - INFO -   üö´ Normalization: DISABLED (forced)
2025-08-01 13:51:29,642 - INFO -   üé≤ Noise: Standard Gaussian (NO SCALING)
2025-08-01 13:51:29,642 - INFO -   Collect statistics: False
2025-08-01 13:51:29,664 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-01 13:51:29,665 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-01 13:51:29,709 - INFO - Prepared 2 shard files
2025-08-01 13:51:29,709 - INFO - Using manifest for length estimation: 5,219 samples
2025-08-01 13:51:29,709 - INFO - FIXED CLIP Reproduction Dataset initialized:
2025-08-01 13:51:29,709 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 13:51:29,709 - INFO -   Mode: patch_only (256 tokens)
2025-08-01 13:51:29,709 - INFO -   TARGET: CLIP embeddings [B, N, 1024] - RAW (no normalization)
2025-08-01 13:51:29,709 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096] - RAW (no normalization)
2025-08-01 13:51:29,709 - INFO -   üö´ Normalization: DISABLED (raw embedding space)
2025-08-01 13:51:29,709 - INFO -   Shards: 2
2025-08-01 13:51:29,709 - INFO -   Statistics collection: False
2025-08-01 13:51:29,710 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-01 13:51:29,710 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-01 13:51:29,710 - INFO - Prepared 2 shard files
2025-08-01 13:51:29,710 - INFO - Using manifest for length estimation: 5,219 samples
2025-08-01 13:51:29,710 - INFO - FIXED CLIP Reproduction Dataset initialized:
2025-08-01 13:51:29,710 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-01 13:51:29,710 - INFO -   Mode: patch_only (256 tokens)
2025-08-01 13:51:29,710 - INFO -   TARGET: CLIP embeddings [B, N, 1024] - RAW (no normalization)
2025-08-01 13:51:29,710 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096] - RAW (no normalization)
2025-08-01 13:51:29,710 - INFO -   üö´ Normalization: DISABLED (raw embedding space)
2025-08-01 13:51:29,710 - INFO -   Shards: 2
2025-08-01 13:51:29,710 - INFO -   Statistics collection: False
2025-08-01 13:51:29,710 - INFO - FIXED: CLIP reproduction dataloaders created successfully
2025-08-01 13:51:29,710 - INFO -   Training dataset length: 5,219
2025-08-01 13:51:29,710 - INFO -   Evaluation dataset length: 5,219
2025-08-01 13:51:29,710 - INFO -   üö´ NO normalization applied in either dataset
2025-08-01 13:51:29,710 - INFO -   üé≤ Standard Gaussian noise (NO SCALING) in collate function
2025-08-01 13:51:29,710 - INFO -   Consistent processing: ‚úÖ
2025-08-01 13:51:29,710 - INFO - Dataloaders created:
2025-08-01 13:51:29,710 - INFO -   Normalization: DISABLED
2025-08-01 13:51:29,710 - INFO -   Max shards: 2
2025-08-01 13:51:29,710 - INFO -   Raw embedding space: ‚úÖ
2025-08-01 13:51:29,711 - INFO - ‚úÖ Imported UPDATED trainer with scale-aware evaluation
2025-08-01 13:51:29,714 - INFO - Got exact dataloader length: 652
2025-08-01 13:51:29,715 - INFO - Optimizer and scheduler setup complete
2025-08-01 13:51:29,715 - INFO -   Total estimated steps: 6520
2025-08-01 13:51:29,715 - INFO -   Warmup steps: 100
2025-08-01 13:51:29,715 - INFO - üîß Preparing overfitting test with 20 samples from EVAL DATA...
2025-08-01 13:51:34,239 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:51:34,297 - INFO - ‚úÖ Using eval_dataloader for overfitting test
2025-08-01 13:51:34,300 - INFO - ‚úÖ Overfitting test prepared with 8 samples:
2025-08-01 13:51:34,300 - INFO -   Overfit CLIP norm: 25.292
2025-08-01 13:51:34,300 - INFO -   Overfit EVA norm: 42.896
2025-08-01 13:51:34,300 - INFO - UPDATED BLIP3-o CLIP Trainer initialized with Scale-Aware Evaluation
2025-08-01 13:51:34,300 - INFO -   Device: cuda
2025-08-01 13:51:34,300 - INFO -   üöÄ Scale-aware evaluation: True
2025-08-01 13:51:34,300 - INFO -   üéØ Adaptive target norm: True
2025-08-01 13:51:34,300 - INFO -   üìÖ Log-normal schedule: True
2025-08-01 13:51:34,301 - INFO -   üîß Enhanced norm tracking enabled
2025-08-01 13:51:34,301 - INFO - UPDATED trainer created with scale-aware evaluation:
2025-08-01 13:51:34,301 - INFO -   üöÄ Scale-aware evaluation: True
2025-08-01 13:51:34,301 - INFO -   üéØ Adaptive target norm: True
2025-08-01 13:51:34,301 - INFO -   üìÖ Log-normal schedule: True
2025-08-01 13:51:34,301 - INFO -   Evaluation: Every 50 steps
2025-08-01 13:51:34,301 - INFO -   WandB enabled: False
2025-08-01 13:51:34,305 - INFO - Configuration saved to checkpoints/clip_repro_20250801_135108/scale_aware_experiment_config.json
2025-08-01 13:51:34,305 - INFO - 
üöÄ Starting BLIP3-o training with Scale-Aware generation...
2025-08-01 13:51:34,305 - INFO - Expected improvements with Scale-Aware Generation:
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ Better scale consistency between training and inference
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ Reduced velocity explosion issues during generation
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ More stable and consistent embedding norms
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ Improved CLIP similarity scores
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ Enhanced convergence and overfitting capability
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ More robust generation across different noise scales
2025-08-01 13:51:34,305 - INFO -   ‚Ä¢ OVERFITTING TEST: Should achieve >0.8 similarity on 20 samples
2025-08-01 13:51:34,305 - INFO -     ‚úÖ Uses same data source as evaluation for consistency
2025-08-01 13:51:34,305 - INFO - 
2025-08-01 13:51:34,305 - INFO - üöÄ Starting BLIP3-o training with Scale-Aware Evaluation...
2025-08-01 13:51:34,306 - INFO -   Model parameters: 249,339,136
2025-08-01 13:51:34,306 - INFO -   üéØ Scale-aware evaluation: True
2025-08-01 13:51:34,306 - INFO -   üìÖ Log-normal schedule: True
2025-08-01 13:51:34,306 - INFO -   üéõÔ∏è  Adaptive target norm: True
2025-08-01 13:51:34,308 - INFO - Starting epoch 1/10
2025-08-01 13:51:38,683 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:51:42,150 - INFO - Step 10: Loss=1.760093, VelSim=0.2699 (fair), GradNorm=37066.811, LR=1.90e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=12.454, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:51:44,972 - INFO - Step 20: Loss=1.671948, VelSim=0.3433 (fair), GradNorm=20663.526, LR=2.80e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=12.250, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:51:47,806 - INFO - Step 30: Loss=1.619757, VelSim=0.3769 (fair), GradNorm=12423.080, LR=3.70e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=13.682, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:51:50,642 - INFO - Step 40: Loss=1.589817, VelSim=0.3945 (fair), GradNorm=26719.675, LR=4.60e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=15.186, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:51:53,477 - INFO - Step 50: Loss=1.540069, VelSim=0.4258 (fair), GradNorm=63049.469, LR=5.50e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=16.577, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:51:53,480 - INFO - üìä NORM ANALYSIS (Scale-Aware):
2025-08-01 13:51:53,480 - INFO -   Training Target Norms: mean=25.292, std=0.000, range=[25.292, 25.292]
2025-08-01 13:51:53,480 - INFO - Running scale-aware evaluation at step 50...
2025-08-01 13:51:57,934 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:52:05,349 - ERROR - Error during epoch 1: a Tensor with 2097152 elements cannot be converted to Scalar
2025-08-01 13:52:05,350 - INFO - Starting epoch 2/10
2025-08-01 13:52:09,911 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:52:12,738 - INFO - Step 60: Loss=1.457046, VelSim=0.4722 (fair), GradNorm=73701.879, LR=6.40e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=18.918, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:15,572 - INFO - Step 70: Loss=1.344535, VelSim=0.5258 (good), GradNorm=105766.314, LR=7.30e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=21.805, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:18,402 - INFO - Step 80: Loss=1.204931, VelSim=0.5854 (good), GradNorm=109234.106, LR=8.20e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=24.873, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:21,240 - INFO - Step 90: Loss=1.078210, VelSim=0.6281 (good), GradNorm=146231.575, LR=9.10e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=26.491, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:24,069 - INFO - Step 100: Loss=0.946970, VelSim=0.6693 (good), GradNorm=164391.825, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=28.135, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:24,069 - INFO - üìä NORM ANALYSIS (Scale-Aware):
2025-08-01 13:52:24,070 - INFO -   Training Target Norms: mean=25.292, std=0.000, range=[25.292, 25.292]
2025-08-01 13:52:24,070 - INFO -   Eval Target Norms: mean=25.856, std=0.564, range=[25.292, 26.420]
2025-08-01 13:52:24,070 - INFO -   Train vs Eval Consistency: ‚úÖ CONSISTENT (diff=0.564)
2025-08-01 13:52:24,070 - INFO - Running scale-aware evaluation at step 100...
2025-08-01 13:52:28,501 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:52:35,721 - ERROR - Error during epoch 2: a Tensor with 2097152 elements cannot be converted to Scalar
2025-08-01 13:52:35,721 - INFO - Starting epoch 3/10
2025-08-01 13:52:40,161 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:52:42,994 - INFO - Step 110: Loss=0.827577, VelSim=0.7066 (good), GradNorm=181774.831, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=29.116, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:45,826 - INFO - Step 120: Loss=0.732228, VelSim=0.7386 (good), GradNorm=190527.341, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=30.941, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:48,655 - INFO - Step 130: Loss=0.646113, VelSim=0.7704 (good), GradNorm=161883.969, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=31.988, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:51,634 - INFO - Step 140: Loss=0.581739, VelSim=0.7950 (good), GradNorm=170047.962, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=32.958, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:54,475 - INFO - Step 150: Loss=0.525471, VelSim=0.8164 (excellent), GradNorm=157417.469, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=34.079, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:52:54,477 - INFO - üìä NORM ANALYSIS (Scale-Aware):
2025-08-01 13:52:54,477 - INFO -   Training Target Norms: mean=25.292, std=0.000, range=[25.292, 25.292]
2025-08-01 13:52:54,477 - INFO -   Eval Target Norms: mean=25.856, std=0.564, range=[25.292, 26.420]
2025-08-01 13:52:54,477 - INFO -   üéØ Target Norm Estimates: mean=25.856, std=0.000
2025-08-01 13:52:54,477 - INFO -   Train vs Eval Consistency: ‚úÖ CONSISTENT (diff=0.564)
2025-08-01 13:52:54,478 - INFO - Running scale-aware evaluation at step 150...
2025-08-01 13:52:58,984 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:53:06,226 - ERROR - Error during epoch 3: a Tensor with 2097152 elements cannot be converted to Scalar
2025-08-01 13:53:06,226 - INFO - Starting epoch 4/10
2025-08-01 13:53:11,628 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:53:14,462 - INFO - Step 160: Loss=0.479010, VelSim=0.8341 (excellent), GradNorm=163530.107, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=34.465, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:17,295 - INFO - Step 170: Loss=0.436171, VelSim=0.8502 (excellent), GradNorm=147746.871, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=35.232, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:20,127 - INFO - Step 180: Loss=0.402680, VelSim=0.8625 (excellent), GradNorm=145247.316, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=35.469, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:22,964 - INFO - Step 190: Loss=0.380032, VelSim=0.8709 (excellent), GradNorm=156346.016, LR=1.00e-04, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=36.061, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:25,806 - INFO - Step 200: Loss=0.345764, VelSim=0.8832 (excellent), GradNorm=134649.250, LR=9.99e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=36.683, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:25,806 - INFO - üìä NORM ANALYSIS (Scale-Aware):
2025-08-01 13:53:25,806 - INFO -   Training Target Norms: mean=25.292, std=0.000, range=[25.292, 25.292]
2025-08-01 13:53:25,806 - INFO -   Eval Target Norms: mean=25.856, std=0.564, range=[25.292, 26.420]
2025-08-01 13:53:25,806 - INFO -   üéØ Target Norm Estimates: mean=25.856, std=0.000
2025-08-01 13:53:25,806 - INFO -   Train vs Eval Consistency: ‚úÖ CONSISTENT (diff=0.564)
2025-08-01 13:53:25,806 - INFO - Running scale-aware evaluation at step 200...
2025-08-01 13:53:31,444 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:53:38,670 - ERROR - Error during epoch 4: a Tensor with 2097152 elements cannot be converted to Scalar
2025-08-01 13:53:38,670 - INFO - Starting epoch 5/10
2025-08-01 13:53:43,073 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:53:45,907 - INFO - Step 210: Loss=0.325514, VelSim=0.8905 (excellent), GradNorm=108723.577, LR=9.99e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=36.765, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:48,739 - INFO - Step 220: Loss=0.314902, VelSim=0.8943 (excellent), GradNorm=107276.508, LR=9.99e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=37.122, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:53:51,003 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:53:51,003 - INFO - Epoch 5 completed:
2025-08-01 13:53:51,003 - INFO -   Average loss: 0.323611
2025-08-01 13:53:51,003 - INFO -   Best loss: 0.295853
2025-08-01 13:53:51,003 - INFO -   Best similarity: 0.9011
2025-08-01 13:53:51,003 - INFO -   Steps in epoch: 28
2025-08-01 13:53:51,003 - INFO -   Epoch time: 12.3s
2025-08-01 13:53:51,004 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:53:51,004 - INFO -     Training target norm: 25.292
2025-08-01 13:53:51,004 - INFO -     Eval target norm: 25.856
2025-08-01 13:53:51,004 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:53:51,004 - INFO - Starting epoch 6/10
2025-08-01 13:53:55,361 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:53:55,649 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:53:55,649 - INFO - Epoch 6 completed:
2025-08-01 13:53:55,649 - INFO -   Average loss: 0.291016
2025-08-01 13:53:55,649 - INFO -   Best loss: 0.291016
2025-08-01 13:53:55,649 - INFO -   Best similarity: 0.9028
2025-08-01 13:53:55,649 - INFO -   Steps in epoch: 1
2025-08-01 13:53:55,649 - INFO -   Epoch time: 4.6s
2025-08-01 13:53:55,649 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:53:55,650 - INFO -     Training target norm: 25.292
2025-08-01 13:53:55,650 - INFO -     Eval target norm: 25.856
2025-08-01 13:53:55,650 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:53:55,650 - INFO - Starting epoch 7/10
2025-08-01 13:53:59,830 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:54:00,116 - INFO - Step 230: Loss=0.295478, VelSim=0.9012 (excellent), GradNorm=128004.247, LR=9.99e-05, Noise=Œº-0.000œÉ0.999‚úÖ, PredNorm=37.596, TargetNorm=41.343, BatchCLIPNorm=25.292 [OVERFIT TEST]
2025-08-01 13:54:00,116 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:54:00,116 - INFO - Epoch 7 completed:
2025-08-01 13:54:00,116 - INFO -   Average loss: 0.295478
2025-08-01 13:54:00,116 - INFO -   Best loss: 0.291016
2025-08-01 13:54:00,116 - INFO -   Best similarity: 0.9028
2025-08-01 13:54:00,116 - INFO -   Steps in epoch: 1
2025-08-01 13:54:00,116 - INFO -   Epoch time: 4.5s
2025-08-01 13:54:00,117 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:54:00,117 - INFO -     Training target norm: 25.292
2025-08-01 13:54:00,117 - INFO -     Eval target norm: 25.856
2025-08-01 13:54:00,117 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:54:00,117 - INFO - Starting epoch 8/10
2025-08-01 13:54:04,317 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:54:04,603 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:54:04,603 - INFO - Epoch 8 completed:
2025-08-01 13:54:04,603 - INFO -   Average loss: 0.286324
2025-08-01 13:54:04,603 - INFO -   Best loss: 0.286324
2025-08-01 13:54:04,603 - INFO -   Best similarity: 0.9045
2025-08-01 13:54:04,603 - INFO -   Steps in epoch: 1
2025-08-01 13:54:04,603 - INFO -   Epoch time: 4.5s
2025-08-01 13:54:04,604 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:54:04,604 - INFO -     Training target norm: 25.292
2025-08-01 13:54:04,604 - INFO -     Eval target norm: 25.856
2025-08-01 13:54:04,604 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:54:04,604 - INFO - Starting epoch 9/10
2025-08-01 13:54:08,726 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:54:09,009 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:54:09,009 - INFO - Epoch 9 completed:
2025-08-01 13:54:09,009 - INFO -   Average loss: 0.290501
2025-08-01 13:54:09,009 - INFO -   Best loss: 0.286324
2025-08-01 13:54:09,009 - INFO -   Best similarity: 0.9045
2025-08-01 13:54:09,009 - INFO -   Steps in epoch: 1
2025-08-01 13:54:09,009 - INFO -   Epoch time: 4.4s
2025-08-01 13:54:09,010 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:54:09,010 - INFO -     Training target norm: 25.292
2025-08-01 13:54:09,010 - INFO -     Eval target norm: 25.856
2025-08-01 13:54:09,010 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:54:09,010 - INFO - Starting epoch 10/10
2025-08-01 13:54:13,115 - INFO - Loaded shard 1/2: 2601 samples, CLIP norm=26.319, EVA norm=43.667
2025-08-01 13:54:13,397 - INFO - üéâ OVERFITTING TEST PASSED! Model can learn effectively with scale-aware generation.
2025-08-01 13:54:13,398 - INFO - Epoch 10 completed:
2025-08-01 13:54:13,398 - INFO -   Average loss: 0.281710
2025-08-01 13:54:13,398 - INFO -   Best loss: 0.281710
2025-08-01 13:54:13,398 - INFO -   Best similarity: 0.9060
2025-08-01 13:54:13,398 - INFO -   Steps in epoch: 1
2025-08-01 13:54:13,398 - INFO -   Epoch time: 4.4s
2025-08-01 13:54:13,398 - INFO -   üìä Scale-Aware Epoch Analysis:
2025-08-01 13:54:13,398 - INFO -     Training target norm: 25.292
2025-08-01 13:54:13,398 - INFO -     Eval target norm: 25.856
2025-08-01 13:54:13,399 - INFO -     üéØ Estimated target norm: 25.856
2025-08-01 13:54:15,387 - INFO - Checkpoint saved: checkpoints/clip_repro_20250801_135108/checkpoint_step_233.pt
2025-08-01 13:54:15,387 - INFO - Running final scale-aware evaluation...
2025-08-01 13:54:20,513 - INFO - Loaded shard 1/2: 2646 samples, CLIP norm=26.278, EVA norm=43.618
2025-08-01 13:54:27,736 - ERROR - ‚ùå Training failed with error: a Tensor with 2097152 elements cannot be converted to Scalar
