2025-08-02 19:03:42,278 - INFO - üöÄ IMPROVED BLIP3-o CLIP Reproduction Training
2025-08-02 19:03:42,280 - INFO - ================================================================================
2025-08-02 19:03:42,280 - INFO - üìã Task: Reproduce CLIP embeddings from EVA embeddings
2025-08-02 19:03:42,280 - INFO - üß† Model: BLIP3-o DiT with CRITICAL IMPROVEMENTS
2025-08-02 19:03:42,280 - INFO - üåä Method: Rectified Flow Matching + Enhancements
2025-08-02 19:03:42,280 - INFO - üéØ Target: CLIP embeddings [B, N, 1024] (PROPERLY NORMALIZED)
2025-08-02 19:03:42,280 - INFO - üéÆ Conditioning: EVA embeddings [B, N, 4096] (ADAPTED)
2025-08-02 19:03:42,280 - INFO - üî• Expected: CLIP similarity 0.21 ‚Üí 0.6+ üöÄ
2025-08-02 19:03:42,280 - INFO - ================================================================================
2025-08-02 19:03:42,280 - INFO - üõ†Ô∏è CRITICAL IMPROVEMENTS:
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 1. CLIP embedding normalization (HIGHEST IMPACT)
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 2. EVA-CLIP adaptation layers
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 3. Heun's solver for O(h¬≤) integration
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 4. U-shaped timestep sampling
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 5. Multi-component semantic-preserving loss
2025-08-02 19:03:42,280 - INFO -    ‚úÖ 6. Improved evaluation with denormalization
2025-08-02 19:03:42,280 - INFO - ================================================================================
2025-08-02 19:03:42,281 - INFO - Configuration:
2025-08-02 19:03:42,281 - INFO -   Model size: base
2025-08-02 19:03:42,281 - INFO -   Training mode: patch_only
2025-08-02 19:03:42,281 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 19:03:42,281 - INFO -   Output dir: ./checkpoints/blip3o_clean_20250802_190340
2025-08-02 19:03:42,281 - INFO -   Learning rate: 0.0001
2025-08-02 19:03:42,281 - INFO -   Batch size: 64
2025-08-02 19:03:42,282 - INFO -   Epochs: 10
2025-08-02 19:03:42,282 - INFO -   Max shards: 3
2025-08-02 19:03:42,282 - INFO -   EVA adapter: ‚úÖ ENABLED
2025-08-02 19:03:42,282 - INFO -   Heun inference: ‚úÖ ENABLED
2025-08-02 19:03:42,735 - INFO - Using GPU: NVIDIA H100
2025-08-02 19:03:42,735 - INFO - GPU Memory: 100.0 GB
2025-08-02 19:03:42,735 - INFO - PyTorch version: 2.7.1+cu126
2025-08-02 19:03:45,422 - INFO - ‚úÖ CLIP DiT model loaded successfully
2025-08-02 19:03:45,423 - INFO - ‚úÖ Flow matching loss loaded successfully
2025-08-02 19:03:46,176 - INFO - ‚úÖ CLIP trainer loaded successfully
2025-08-02 19:03:46,177 - WARNING - ‚ö†Ô∏è Failed to import dataset: cannot import name 'create_clip_reproduction_dataloaders' from 'src.modules.datasets.blip3o_dataset' (/gpfs/home4/azadaianchuk1/eva-clip-v6_1/src/modules/datasets/blip3o_dataset.py)
2025-08-02 19:03:46,179 - INFO - ‚úÖ Configuration loaded successfully
2025-08-02 19:03:46,179 - WARNING - ‚ö†Ô∏è Missing components: ['dataset']
2025-08-02 19:03:46,179 - WARNING - ‚ö†Ô∏è Partial initialization. Missing: ['dataset']
2025-08-02 19:03:46,179 - INFO - ‚úÖ All improved modules imported successfully
2025-08-02 19:03:46,179 - INFO - ‚úÖ Environment check passed
2025-08-02 19:03:46,179 - INFO - ‚úÖ Output directory ready: checkpoints/blip3o_clean_20250802_190340
2025-08-02 19:03:46,179 - INFO - üèóÔ∏è Creating IMPROVED model...
2025-08-02 19:03:46,179 - INFO - ‚úÖ Configuration validation passed
2025-08-02 19:03:46,611 - INFO - ‚úÖ EVA-CLIP Adapter initialized: 4096 ‚Üí 768
2025-08-02 19:03:46,612 - INFO -    Layers: 6, Dropout: 0.1, Residual: True
2025-08-02 19:03:48,057 - INFO - ‚úÖ Stable initialization applied with depth scale: 0.2887
2025-08-02 19:03:48,058 - INFO - ‚úÖ IMPROVED BLIP3-o CLIP DiT model initialized: 227,474,014 parameters
2025-08-02 19:03:48,059 - INFO -   üî• EVA adapter: ENABLED
2025-08-02 19:03:48,059 - INFO -   üöÄ Heun solver: ENABLED
2025-08-02 19:03:48,059 - INFO -   ‚ö° Attention caching: Available
2025-08-02 19:03:48,059 - INFO - ‚úÖ IMPROVED BLIP3-o model created:
2025-08-02 19:03:48,059 - INFO -    Size: base
2025-08-02 19:03:48,060 - INFO -    Parameters: 227,474,014
2025-08-02 19:03:48,060 - INFO -    EVA adapter: ‚úÖ
2025-08-02 19:03:48,060 - INFO -    Heun solver: ‚úÖ
2025-08-02 19:03:48,060 - INFO -    3D RoPE: ‚úÖ
2025-08-02 19:03:48,060 - INFO -    Sandwich norm: ‚úÖ
2025-08-02 19:03:48,276 - INFO - ‚úÖ IMPROVED model created with 227,474,014 parameters
2025-08-02 19:03:48,276 - INFO -   Model size: base
2025-08-02 19:03:48,276 - INFO -   Training mode: patch_only
2025-08-02 19:03:48,276 - INFO -   3D RoPE: ‚úÖ ENABLED
2025-08-02 19:03:48,276 - INFO -   Sandwich Norm: ‚úÖ ENABLED
2025-08-02 19:03:48,276 - INFO -   EVA Adapter: ‚úÖ ENABLED
2025-08-02 19:03:48,276 - INFO -   Heun Solver: ‚úÖ ENABLED
2025-08-02 19:03:48,276 - INFO - üåä Creating IMPROVED loss function...
2025-08-02 19:03:48,276 - INFO - ‚úÖ IMPROVED Flow Matching Loss initialized:
2025-08-02 19:03:48,276 - INFO -   Prediction type: velocity
2025-08-02 19:03:48,276 - INFO -   Flow type: rectified
2025-08-02 19:03:48,277 - INFO -   Weights - Velocity: 1.0, Semantic: 0.1, Cosine: 0.05
2025-08-02 19:03:48,277 - INFO -   Timestep weighting: True
2025-08-02 19:03:48,277 - INFO - ‚úÖ IMPROVED loss function created:
2025-08-02 19:03:48,277 - INFO -   Prediction type: velocity
2025-08-02 19:03:48,277 - INFO -   Flow type: rectified
2025-08-02 19:03:48,277 - INFO -   Velocity weight: 1.0
2025-08-02 19:03:48,277 - INFO -   Semantic weight: 0.1
2025-08-02 19:03:48,277 - INFO -   Cosine weight: 0.05
2025-08-02 19:03:48,277 - INFO -   Timestep weighting: ‚úÖ ENABLED
2025-08-02 19:03:48,277 - INFO - üìä Creating IMPROVED dataloaders...
2025-08-02 19:03:48,277 - INFO - Loading embeddings from: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 19:03:48,277 - INFO - Found 35 .pkl files in embeddings directory
2025-08-02 19:03:48,277 - INFO - Creating IMPROVED CLIP reproduction dataloaders:
2025-08-02 19:03:48,277 - INFO -   Target: CLIP embeddings [B, N, 1024] (PROPERLY NORMALIZED)
2025-08-02 19:03:48,277 - INFO -   Conditioning: EVA embeddings [B, N, 4096]
2025-08-02 19:03:48,278 - INFO -   Timestep sampling: U-shaped distribution
2025-08-02 19:03:48,278 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-02 19:03:48,278 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-02 19:03:48,278 - INFO - Prepared 3 shard files
2025-08-02 19:03:48,278 - INFO - Computing CLIP embedding statistics from 3 shards...
2025-08-02 19:03:52,684 - INFO -    Processed shard 1: torch.Size([2601, 256, 1024])
2025-08-02 19:03:57,165 - INFO -    Processed shard 2: torch.Size([2646, 256, 1024])
2025-08-02 19:04:01,798 - INFO -    Processed shard 3: torch.Size([2585, 256, 1024])
2025-08-02 19:04:01,948 - INFO - Computing stats from 2,004,992 embedding vectors
2025-08-02 19:04:05,225 - INFO - ‚úÖ CLIP normalization statistics computed:
2025-08-02 19:04:05,226 - INFO -    Mean range: [-7.372027, 6.008663]
2025-08-02 19:04:05,226 - INFO -    Std range: [0.498689, 17.372086]
2025-08-02 19:04:05,226 - INFO -    Scale factor: 4.00
2025-08-02 19:04:05,226 - INFO -    Test normalization range: [-25.9129, 30.3969]
2025-08-02 19:04:05,402 - INFO - Using manifest for length estimation: 7,828 samples
2025-08-02 19:04:05,402 - INFO - UPDATED CLIP Reproduction Dataset initialized:
2025-08-02 19:04:05,402 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 19:04:05,403 - INFO -   Mode: patch_only (256 tokens)
2025-08-02 19:04:05,403 - INFO -   TARGET: CLIP embeddings [B, N, 1024] (PROPERLY NORMALIZED)
2025-08-02 19:04:05,403 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-02 19:04:05,403 - INFO -   Shards: 3
2025-08-02 19:04:05,403 - INFO -   ‚úÖ CLIP normalization: ENABLED
2025-08-02 19:04:05,403 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-08-02 19:04:05,403 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-08-02 19:04:05,403 - INFO - Prepared 3 shard files
2025-08-02 19:04:05,403 - INFO - Computing CLIP embedding statistics from 3 shards...
2025-08-02 19:04:09,417 - INFO -    Processed shard 1: torch.Size([2646, 256, 1024])
2025-08-02 19:04:13,439 - INFO -    Processed shard 2: torch.Size([2601, 256, 1024])
2025-08-02 19:04:17,388 - INFO -    Processed shard 3: torch.Size([2585, 256, 1024])
2025-08-02 19:04:17,538 - INFO - Computing stats from 2,004,992 embedding vectors
2025-08-02 19:04:20,808 - INFO - ‚úÖ CLIP normalization statistics computed:
2025-08-02 19:04:20,809 - INFO -    Mean range: [-7.372026, 6.008663]
2025-08-02 19:04:20,809 - INFO -    Std range: [0.498689, 17.372086]
2025-08-02 19:04:20,809 - INFO -    Scale factor: 4.00
2025-08-02 19:04:20,809 - INFO -    Test normalization range: [-43.5248, 46.8889]
2025-08-02 19:04:20,969 - INFO - Using manifest for length estimation: 7,828 samples
2025-08-02 19:04:20,969 - INFO - UPDATED CLIP Reproduction Dataset initialized:
2025-08-02 19:04:20,969 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-08-02 19:04:20,969 - INFO -   Mode: patch_only (256 tokens)
2025-08-02 19:04:20,969 - INFO -   TARGET: CLIP embeddings [B, N, 1024] (PROPERLY NORMALIZED)
2025-08-02 19:04:20,969 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-08-02 19:04:20,970 - INFO -   Shards: 3
2025-08-02 19:04:20,970 - INFO -   ‚úÖ CLIP normalization: ENABLED
2025-08-02 19:04:20,970 - INFO - ‚úÖ IMPROVED CLIP reproduction dataloaders created
2025-08-02 19:04:20,970 - INFO -   Training dataset length: 7,828
2025-08-02 19:04:20,970 - INFO -   Evaluation dataset length: 7,828
2025-08-02 19:04:20,970 - INFO -   üî• CLIP normalization: PROPERLY CONFIGURED
2025-08-02 19:04:20,970 - INFO - ‚úÖ IMPROVED dataloaders created successfully:
2025-08-02 19:04:20,970 - INFO -   Training mode: patch_only
2025-08-02 19:04:20,970 - INFO -   Batch size: 64
2025-08-02 19:04:20,970 - INFO -   Max shards: 3
2025-08-02 19:04:20,970 - INFO -   üî• CLIP normalization: ‚úÖ PROPERLY CONFIGURED
2025-08-02 19:04:20,970 - INFO -   üî• U-shaped timestep sampling: ‚úÖ ENABLED
2025-08-02 19:04:25,234 - INFO - ‚úÖ Dataloader test successful:
2025-08-02 19:04:25,234 - INFO -   Batch size: 64
2025-08-02 19:04:25,235 - INFO -   CLIP embeddings shape: torch.Size([64, 256, 1024])
2025-08-02 19:04:25,235 - INFO -   EVA embeddings shape: torch.Size([64, 256, 4096])
2025-08-02 19:04:25,235 - INFO -   üî• CLIP normalizer: ‚úÖ AVAILABLE
2025-08-02 19:04:25,235 - INFO -      Scale factor: 4.00
2025-08-02 19:04:25,235 - INFO - üèÉ Creating IMPROVED trainer...
2025-08-02 19:04:25,239 - INFO - Got exact dataloader length: 122
2025-08-02 19:04:25,240 - INFO - Optimizer and scheduler setup complete
2025-08-02 19:04:25,240 - INFO -   Total estimated steps: 1220
2025-08-02 19:04:25,240 - INFO -   Warmup steps: 100
2025-08-02 19:04:25,240 - INFO - ‚úÖ IMPROVED BLIP3-o CLIP Trainer initialized
2025-08-02 19:04:25,240 - INFO -   Device: cuda
2025-08-02 19:04:25,241 - INFO -   Parameters: 227,474,014
2025-08-02 19:04:25,241 - INFO -   CLIP normalizer: ‚úÖ AVAILABLE
2025-08-02 19:04:25,241 - INFO -   Heun inference: ‚úÖ ENABLED
2025-08-02 19:04:25,241 - INFO - ‚úÖ IMPROVED trainer created successfully:
2025-08-02 19:04:25,241 - INFO -   Evaluation: Every 50 steps
2025-08-02 19:04:25,241 - INFO -   WandB enabled: False
2025-08-02 19:04:25,241 - INFO -   CLIP normalizer: ‚úÖ AVAILABLE
2025-08-02 19:04:25,241 - INFO -   Heun inference: ‚úÖ ENABLED
2025-08-02 19:04:25,241 - INFO - üíæ Saving experiment configuration...
2025-08-02 19:04:25,244 - INFO - ‚úÖ IMPROVED configuration saved to checkpoints/blip3o_clean_20250802_190340/experiment_config.json
2025-08-02 19:04:25,244 - INFO - 
üöÄ Starting IMPROVED BLIP3-o training...
2025-08-02 19:04:25,244 - INFO - ================================================================================
2025-08-02 19:04:25,244 - INFO - üî• Expected Results Timeline:
2025-08-02 19:04:25,244 - INFO -    ‚Ä¢ After CLIP normalization fix: 0.21 ‚Üí 0.45+ (IMMEDIATE)
2025-08-02 19:04:25,244 - INFO -    ‚Ä¢ After Heun solver: 0.45 ‚Üí 0.55+
2025-08-02 19:04:25,244 - INFO -    ‚Ä¢ After EVA adapter: 0.55 ‚Üí 0.65+
2025-08-02 19:04:25,244 - INFO -    ‚Ä¢ After all improvements: 0.65 ‚Üí 0.70+
2025-08-02 19:04:25,244 - INFO - ================================================================================
2025-08-02 19:04:25,244 - INFO - üöÄ Starting IMPROVED BLIP3-o training...
2025-08-02 19:04:25,245 - INFO -   Model parameters: 227,474,014
2025-08-02 19:04:25,245 - INFO -   CLIP normalizer: ‚úÖ AVAILABLE
2025-08-02 19:04:25,245 - INFO -   Heun inference: ‚úÖ ENABLED
2025-08-02 19:04:25,247 - INFO - Starting epoch 1/10
2025-08-02 19:04:35,652 - INFO - Step 10: Loss=16.752810, VelSim=0.0970, CleanSim=0.7313, GradNorm=49043.743, LR=1.90e-05
2025-08-02 19:04:41,561 - INFO - Step 20: Loss=16.690725, VelSim=0.0912, CleanSim=0.7183, GradNorm=385229.451, LR=2.80e-05
2025-08-02 19:04:47,481 - INFO - Step 30: Loss=16.935286, VelSim=0.1624, CleanSim=0.8329, GradNorm=212598.990, LR=3.70e-05
2025-08-02 19:04:53,382 - INFO - Step 40: Loss=16.649483, VelSim=0.1994, CleanSim=0.7061, GradNorm=101285.380, LR=4.60e-05
2025-08-02 19:05:03,854 - INFO - Step 50: Loss=16.033773, VelSim=0.2050, CleanSim=0.6926, GradNorm=101389.218, LR=5.50e-05
2025-08-02 19:05:03,854 - INFO - Running IMPROVED evaluation at step 50...
2025-08-02 19:05:03,854 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:05:50,773 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:05:50,773 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:05:50,773 - INFO -    CLIP similarity: 0.5026
2025-08-02 19:05:50,773 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:05:50,773 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:05:50,775 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:05:50,775 - INFO -   CLIP similarity: 0.5026
2025-08-02 19:05:50,775 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:05:50,775 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:05:50,775 - INFO -   Normalization applied: True
2025-08-02 19:05:56,677 - INFO - Step 60: Loss=15.509305, VelSim=0.2532, CleanSim=0.8352, GradNorm=104980.250, LR=6.40e-05
2025-08-02 19:06:02,583 - INFO - Step 70: Loss=15.647418, VelSim=0.2239, CleanSim=0.7189, GradNorm=464165.355, LR=7.30e-05
2025-08-02 19:06:08,487 - INFO - Step 80: Loss=15.173332, VelSim=0.2354, CleanSim=0.7002, GradNorm=126470.550, LR=8.20e-05
2025-08-02 19:06:18,919 - INFO - Step 90: Loss=15.378454, VelSim=0.2102, CleanSim=0.6941, GradNorm=129215.506, LR=9.10e-05
2025-08-02 19:06:24,811 - INFO - Step 100: Loss=14.686450, VelSim=0.2518, CleanSim=0.5894, GradNorm=141195.931, LR=1.00e-04
2025-08-02 19:06:24,811 - INFO - Running IMPROVED evaluation at step 100...
2025-08-02 19:06:24,811 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:07:12,138 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:07:12,139 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:07:12,139 - INFO -    CLIP similarity: 0.4941
2025-08-02 19:07:12,139 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:07:12,139 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:07:12,140 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:07:12,140 - INFO -   CLIP similarity: 0.4941
2025-08-02 19:07:12,140 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:07:12,140 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:07:12,140 - INFO -   Normalization applied: True
2025-08-02 19:07:18,047 - INFO - Step 110: Loss=14.847901, VelSim=0.2305, CleanSim=0.7288, GradNorm=140475.149, LR=1.00e-04
2025-08-02 19:07:23,958 - INFO - Step 120: Loss=14.628894, VelSim=0.2403, CleanSim=0.6945, GradNorm=139114.252, LR=9.99e-05
2025-08-02 19:07:25,294 - INFO - Iteration completed: 7832 samples processed
2025-08-02 19:07:25,295 - INFO - Epoch 1 completed: 122 batches processed
2025-08-02 19:07:25,309 - INFO - Epoch 1 completed:
2025-08-02 19:07:25,309 - INFO -   Average loss: 15.894901
2025-08-02 19:07:25,309 - INFO -   Best loss: 14.328117
2025-08-02 19:07:25,309 - INFO -   Best similarity: 0.8352
2025-08-02 19:07:25,309 - INFO -   Steps in epoch: 122
2025-08-02 19:07:25,310 - INFO -   Epoch time: 180.1s
2025-08-02 19:07:25,310 - INFO - Starting epoch 2/10
2025-08-02 19:07:34,429 - INFO - Step 130: Loss=14.959932, VelSim=0.2683, CleanSim=0.6983, GradNorm=207515.764, LR=9.98e-05
2025-08-02 19:07:40,331 - INFO - Step 140: Loss=14.533418, VelSim=0.2596, CleanSim=0.6112, GradNorm=74228.550, LR=9.97e-05
2025-08-02 19:07:46,241 - INFO - Step 150: Loss=14.350755, VelSim=0.2594, CleanSim=0.6789, GradNorm=49759.842, LR=9.95e-05
2025-08-02 19:07:46,241 - INFO - Running IMPROVED evaluation at step 150...
2025-08-02 19:07:46,241 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:08:33,321 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:08:33,322 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:08:33,322 - INFO -    CLIP similarity: 0.4888
2025-08-02 19:08:33,322 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:08:33,322 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:08:33,323 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:08:33,323 - INFO -   CLIP similarity: 0.4888
2025-08-02 19:08:33,323 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:08:33,323 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:08:33,323 - INFO -   Normalization applied: True
2025-08-02 19:08:39,225 - INFO - Step 160: Loss=14.566753, VelSim=0.2557, CleanSim=0.6628, GradNorm=72735.894, LR=9.93e-05
2025-08-02 19:08:49,606 - INFO - Step 170: Loss=14.624295, VelSim=0.2529, CleanSim=0.5978, GradNorm=66536.914, LR=9.90e-05
2025-08-02 19:08:55,505 - INFO - Step 180: Loss=14.072803, VelSim=0.2918, CleanSim=0.7020, GradNorm=100030.756, LR=9.88e-05
2025-08-02 19:09:01,402 - INFO - Step 190: Loss=14.199350, VelSim=0.3011, CleanSim=0.6752, GradNorm=100071.808, LR=9.84e-05
2025-08-02 19:09:07,300 - INFO - Step 200: Loss=13.525455, VelSim=0.3285, CleanSim=0.6812, GradNorm=73149.484, LR=9.81e-05
2025-08-02 19:09:07,300 - INFO - Running IMPROVED evaluation at step 200...
2025-08-02 19:09:07,300 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:09:54,421 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:09:54,421 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:09:54,422 - INFO -    CLIP similarity: 0.4748
2025-08-02 19:09:54,422 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:09:54,422 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:09:54,423 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:09:54,423 - INFO -   CLIP similarity: 0.4748
2025-08-02 19:09:54,423 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:09:54,423 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:09:54,423 - INFO -   Normalization applied: True
2025-08-02 19:10:04,755 - INFO - Step 210: Loss=14.118697, VelSim=0.2877, CleanSim=0.5973, GradNorm=117822.017, LR=9.77e-05
2025-08-02 19:10:10,646 - INFO - Step 220: Loss=14.134949, VelSim=0.3123, CleanSim=0.7120, GradNorm=225933.072, LR=9.72e-05
2025-08-02 19:10:16,535 - INFO - Step 230: Loss=13.806129, VelSim=0.3245, CleanSim=0.5682, GradNorm=164387.012, LR=9.67e-05
2025-08-02 19:10:22,424 - INFO - Step 240: Loss=13.169076, VelSim=0.3703, CleanSim=0.5963, GradNorm=71376.002, LR=9.62e-05
2025-08-02 19:10:24,911 - INFO - Iteration completed: 7832 samples processed
2025-08-02 19:10:24,911 - INFO - Epoch 2 completed: 122 batches processed
2025-08-02 19:10:24,925 - INFO - Epoch 2 completed:
2025-08-02 19:10:24,925 - INFO -   Average loss: 14.241713
2025-08-02 19:10:24,925 - INFO -   Best loss: 13.169076
2025-08-02 19:10:24,925 - INFO -   Best similarity: 0.8352
2025-08-02 19:10:24,926 - INFO -   Steps in epoch: 122
2025-08-02 19:10:24,926 - INFO -   Epoch time: 179.6s
2025-08-02 19:10:24,926 - INFO - Starting epoch 3/10
2025-08-02 19:10:33,057 - INFO - Step 250: Loss=13.357132, VelSim=0.3462, CleanSim=0.6418, GradNorm=67058.036, LR=9.57e-05
2025-08-02 19:10:33,058 - INFO - Running IMPROVED evaluation at step 250...
2025-08-02 19:10:33,058 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:11:20,349 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:11:20,349 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:11:20,349 - INFO -    CLIP similarity: 0.4644
2025-08-02 19:11:20,349 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:11:20,350 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:11:20,351 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:11:20,351 - INFO -   CLIP similarity: 0.4644
2025-08-02 19:11:20,351 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:11:20,351 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:11:20,351 - INFO -   Normalization applied: True
2025-08-02 19:11:26,252 - INFO - Step 260: Loss=13.636651, VelSim=0.3341, CleanSim=0.5509, GradNorm=102999.332, LR=9.51e-05
2025-08-02 19:11:32,149 - INFO - Step 270: Loss=13.573277, VelSim=0.3348, CleanSim=0.5880, GradNorm=114993.605, LR=9.45e-05
2025-08-02 19:11:38,046 - INFO - Step 280: Loss=13.452487, VelSim=0.3713, CleanSim=0.5970, GradNorm=79960.883, LR=9.38e-05
2025-08-02 19:11:48,656 - INFO - Step 290: Loss=13.419292, VelSim=0.3477, CleanSim=0.5369, GradNorm=77464.357, LR=9.31e-05
2025-08-02 19:11:54,557 - INFO - Step 300: Loss=13.352444, VelSim=0.3843, CleanSim=0.6743, GradNorm=67549.631, LR=9.24e-05
2025-08-02 19:11:54,558 - INFO - Running IMPROVED evaluation at step 300...
2025-08-02 19:11:54,558 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:12:41,493 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:12:41,493 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:12:41,493 - INFO -    CLIP similarity: 0.4584
2025-08-02 19:12:41,493 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:12:41,493 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:12:41,494 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:12:41,494 - INFO -   CLIP similarity: 0.4584
2025-08-02 19:12:41,494 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:12:41,494 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:12:41,494 - INFO -   Normalization applied: True
2025-08-02 19:12:47,395 - INFO - Step 310: Loss=13.343887, VelSim=0.3694, CleanSim=0.6810, GradNorm=103409.057, LR=9.17e-05
2025-08-02 19:12:53,293 - INFO - Step 320: Loss=12.939034, VelSim=0.4010, CleanSim=0.5312, GradNorm=136285.903, LR=9.09e-05
2025-08-02 19:13:03,965 - INFO - Step 330: Loss=12.556873, VelSim=0.4058, CleanSim=0.5416, GradNorm=117970.348, LR=9.01e-05
2025-08-02 19:13:09,857 - INFO - Step 340: Loss=13.163251, VelSim=0.3947, CleanSim=0.6422, GradNorm=84299.132, LR=8.92e-05
2025-08-02 19:13:15,747 - INFO - Step 350: Loss=12.932005, VelSim=0.3968, CleanSim=0.5177, GradNorm=72531.271, LR=8.83e-05
2025-08-02 19:13:15,748 - INFO - Running IMPROVED evaluation at step 350...
2025-08-02 19:13:15,748 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:14:02,993 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:14:02,995 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:14:02,995 - INFO -    CLIP similarity: 0.4505
2025-08-02 19:14:02,995 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:14:02,995 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:14:02,996 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:14:02,996 - INFO -   CLIP similarity: 0.4505
2025-08-02 19:14:02,996 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:14:02,996 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:14:02,996 - INFO -   Normalization applied: True
2025-08-02 19:14:08,892 - INFO - Step 360: Loss=12.307641, VelSim=0.4417, CleanSim=0.6871, GradNorm=63151.605, LR=8.74e-05
2025-08-02 19:14:12,583 - INFO - Iteration completed: 7832 samples processed
2025-08-02 19:14:12,583 - INFO - Epoch 3 completed: 122 batches processed
2025-08-02 19:14:12,598 - INFO - Epoch 3 completed:
2025-08-02 19:14:12,598 - INFO -   Average loss: 13.169298
2025-08-02 19:14:12,598 - INFO -   Best loss: 12.307641
2025-08-02 19:14:12,598 - INFO -   Best similarity: 0.8352
2025-08-02 19:14:12,598 - INFO -   Steps in epoch: 122
2025-08-02 19:14:12,598 - INFO -   Epoch time: 227.7s
2025-08-02 19:14:12,598 - INFO - Starting epoch 4/10
2025-08-02 19:14:19,528 - INFO - Step 370: Loss=12.577712, VelSim=0.4148, CleanSim=0.5363, GradNorm=145058.562, LR=8.65e-05
2025-08-02 19:14:25,418 - INFO - Step 380: Loss=12.919742, VelSim=0.4132, CleanSim=0.5237, GradNorm=140171.788, LR=8.55e-05
2025-08-02 19:14:31,317 - INFO - Step 390: Loss=12.349386, VelSim=0.4351, CleanSim=0.5713, GradNorm=90106.569, LR=8.45e-05
2025-08-02 19:14:37,209 - INFO - Step 400: Loss=12.518614, VelSim=0.4329, CleanSim=0.5268, GradNorm=95812.908, LR=8.35e-05
2025-08-02 19:14:37,211 - INFO - Running IMPROVED evaluation at step 400...
2025-08-02 19:14:37,211 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:15:24,509 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:15:24,509 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:15:24,509 - INFO -    CLIP similarity: 0.4617
2025-08-02 19:15:24,509 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:15:24,509 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:15:24,510 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:15:24,510 - INFO -   CLIP similarity: 0.4617
2025-08-02 19:15:24,510 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:15:24,510 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:15:24,510 - INFO -   Normalization applied: True
2025-08-02 19:15:35,142 - INFO - Step 410: Loss=12.987473, VelSim=0.4272, CleanSim=0.5644, GradNorm=84327.817, LR=8.24e-05
2025-08-02 19:15:41,033 - INFO - Step 420: Loss=12.340536, VelSim=0.4414, CleanSim=0.5260, GradNorm=86663.715, LR=8.14e-05
2025-08-02 19:15:46,925 - INFO - Step 430: Loss=12.499622, VelSim=0.4456, CleanSim=0.5935, GradNorm=82037.220, LR=8.03e-05
2025-08-02 19:15:52,815 - INFO - Step 440: Loss=12.414548, VelSim=0.4305, CleanSim=0.5217, GradNorm=102740.139, LR=7.91e-05
2025-08-02 19:16:03,367 - INFO - Step 450: Loss=12.195367, VelSim=0.4586, CleanSim=0.6071, GradNorm=107070.002, LR=7.80e-05
2025-08-02 19:16:03,368 - INFO - Running IMPROVED evaluation at step 450...
2025-08-02 19:16:03,368 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:16:50,548 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:16:50,549 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:16:50,549 - INFO -    CLIP similarity: 0.4582
2025-08-02 19:16:50,549 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:16:50,549 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:16:50,550 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:16:50,550 - INFO -   CLIP similarity: 0.4582
2025-08-02 19:16:50,550 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:16:50,550 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:16:50,550 - INFO -   Normalization applied: True
2025-08-02 19:16:56,445 - INFO - Step 460: Loss=12.211514, VelSim=0.4515, CleanSim=0.4839, GradNorm=128980.398, LR=7.68e-05
2025-08-02 19:17:02,343 - INFO - Step 470: Loss=12.450354, VelSim=0.4635, CleanSim=0.5440, GradNorm=138139.905, LR=7.56e-05
2025-08-02 19:17:08,237 - INFO - Step 480: Loss=12.428978, VelSim=0.4442, CleanSim=0.3649, GradNorm=131678.272, LR=7.44e-05
2025-08-02 19:17:13,116 - INFO - Iteration completed: 7832 samples processed
2025-08-02 19:17:13,116 - INFO - Epoch 4 completed: 122 batches processed
2025-08-02 19:17:13,131 - INFO - Epoch 4 completed:
2025-08-02 19:17:13,131 - INFO -   Average loss: 12.390736
2025-08-02 19:17:13,131 - INFO -   Best loss: 11.235578
2025-08-02 19:17:13,131 - INFO -   Best similarity: 0.8352
2025-08-02 19:17:13,131 - INFO -   Steps in epoch: 122
2025-08-02 19:17:13,131 - INFO -   Epoch time: 180.5s
2025-08-02 19:17:13,131 - INFO - Starting epoch 5/10
2025-08-02 19:17:19,036 - INFO - Step 490: Loss=12.048034, VelSim=0.4736, CleanSim=0.5612, GradNorm=136406.463, LR=7.32e-05
2025-08-02 19:17:24,927 - INFO - Step 500: Loss=11.981664, VelSim=0.4656, CleanSim=0.4187, GradNorm=133412.717, LR=7.20e-05
2025-08-02 19:17:24,928 - INFO - Running IMPROVED evaluation at step 500...
2025-08-02 19:17:24,928 - INFO - Starting IMPROVED evaluation with 100 samples
2025-08-02 19:18:12,537 - INFO - ‚úÖ Evaluation with denormalization completed
2025-08-02 19:18:12,539 - INFO - ‚úÖ IMPROVED evaluation completed: 128 samples
2025-08-02 19:18:12,539 - INFO -    CLIP similarity: 0.4686
2025-08-02 19:18:12,539 - INFO -    High quality (>0.7): 0.0%
2025-08-02 19:18:12,539 - INFO -    Very high quality (>0.8): 0.0%
2025-08-02 19:18:12,541 - INFO - ‚úÖ IMPROVED evaluation results:
2025-08-02 19:18:12,541 - INFO -   CLIP similarity: 0.4686
2025-08-02 19:18:12,541 - INFO -   High quality (>0.7): 0.0%
2025-08-02 19:18:12,541 - INFO -   Very high quality (>0.8): 0.0%
2025-08-02 19:18:12,541 - INFO -   Normalization applied: True
2025-08-02 19:18:12,541 - INFO - Attempting to save checkpoint at step 500...
2025-08-02 19:18:14,207 - INFO - ‚úÖ Checkpoint saved successfully: checkpoints/blip3o_clean_20250802_190340/checkpoint_step_500.pt
2025-08-02 19:18:14,207 - INFO -    Size: 2.73 GB
2025-08-02 19:18:20,048 - INFO - Step 510: Loss=11.646862, VelSim=0.4902, CleanSim=0.5480, GradNorm=152877.244, LR=7.07e-05
2025-08-02 19:18:25,950 - INFO - Step 520: Loss=11.500015, VelSim=0.5082, CleanSim=0.5472, GradNorm=112204.653, LR=6.94e-05
2025-08-02 19:18:36,455 - INFO - Step 530: Loss=11.054419, VelSim=0.5297, CleanSim=0.6109, GradNorm=132823.524, LR=6.82e-05
2025-08-02 19:18:42,363 - INFO - Step 540: Loss=11.686859, VelSim=0.4992, CleanSim=0.5451, GradNorm=130155.519, LR=6.68e-05
2025-08-02 19:18:48,259 - INFO - Step 550: Loss=11.575054, VelSim=0.5169, CleanSim=0.5762, GradNorm=162665.103, LR=6.55e-05
2025-08-02 19:18:48,259 - INFO - Running IMPROVED evaluation at step 550...
2025-08-02 19:18:48,259 - INFO - Starting IMPROVED evaluation with 100 samples
